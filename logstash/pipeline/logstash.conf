input {
  file {
    path => "/app/tmp/myapp.logs"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => plain
  }
}

filter {
    grok {
        match => { "message" => "^(?<log_level>WARNING|ERROR|INFO) %{TIMESTAMP_ISO8601:timestamp} %{GREEDYDATA:log_message}" }
    }
    date {
        match => [ "timestamp", "YYYY-MM-dd HH:mm:ss,SSS" ]
        target => "@timestamp"
    }
}

output {
  elasticsearch {
    hosts => ["${ELASTICSEARCH_HOSTS}"]
    index => "logstash-%{+YYYY.MM.dd}"
    user => "${ELASTICSEARCH_USERNAME}" # имя пользователя
    password => "${ELASTICSEARCH_PASSWORD}" # пароль
  }
  stdout { codec => rubydebug }  # Для отладки, вывод данных в консоль
}